<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title></title>
    <link rel="stylesheet" type="text/css" href="multi-vis.css">
    <script src="http://d3js.org/d3.v3.js" charset="utf-8"></script>
</head>
<body>
<div id="writer">
    <span id='sentence'></span>
    <span id='char'></span>
</div>
<script type="text/javascript">

var w = 600;
var h = 600;
var padding = 30;

var dailyDeaths = 3025;
var dailyDeathsArray = [];

var counterLimit = [3000]

for (var i = 1; i <= dailyDeaths; i++) {
   dailyDeathsArray.push(i);
}

var svgContainer = d3.select("body")
    .append("svg")
    .attr("width", w)
    .attr("height", h);

var circle = svgContainer
    .selectAll("circle")
    .data(dailyDeathsArray)
    .enter()
    .append("circle")
    .attr("cx", w/2)
    .attr("cy", h/2)
    .attr("r", h/4)
    .attr("fill", d3.rgb(Math.random()*255, Math.random()*255, Math.random()*255));

var circles = circle
    .transition()
    .delay(500)
    .duration(5500)
    .attr("cx", function(d,i) {return (d % Math.sqrt(dailyDeaths))*(w/Math.sqrt(dailyDeaths)) - padding; })
    .attr("cy", function(d,i) {return ((d-(d % Math.sqrt(dailyDeaths))) / Math.sqrt(dailyDeaths))*(h/Math.sqrt(dailyDeaths)) - padding;})
    .attr("r", 4)
    .style("opacity", function(d) {if (d > 3000) {return 0;} else {return 0.9;}})
    .attr("fill", d3.rgb(Math.random()*255, Math.random()*255, Math.random()*255))

var circlesDis = circles
    .transition()
    .delay(function(d,i) {return 6000 + i*5})
    .duration(5000)
    .attr('transform', function (d) {return "rotate(" + (-1)**Math.round(Math.random())  * Math.random() * Math.PI +")";})
    .attr("r", 0);

var text = svgContainer
    .data([3000])
    .append("text")
    .text("That is")
    .attr("x", w/2)
    .attr("y", h/2)
    .attr("text-anchor", "middle")
    .attr("font-family", "courier new")
    .attr("font-size", "30px")
    .transition()
    .delay(6000)
    .duration(18500)
    .tween("text", function (d) {
            var i = d3.interpolate(1, d),
                prec = (d + "").split("."),
                round = (prec.length > 1) ? Math.pow(10, prec[1].length) :1;
            return function (t) {
                this.textContent = Math.round(i(t)*round)/round + " adolescent deaths a day.";
            };
        })
    .attr("font-size", "30px");

</script>
</body>
</html>